# summary: '
# SELECT ?subject ?predicate ?object
# WHERE {?subject ?predicate ?object} 
# LIMIT 100
# '

summary: '
SELECT ?hs ?p ?ho
WHERE 
{
    {
        SELECT ?s (SHA1(group_concat(?p; separator = ",")) as ?sID) WHERE {
            SELECT DISTINCT ?s ?p {    
                ?s ?p ?_
            } order by ?p
        } group by ?s
    }
    BIND(URI(CONCAT("http://example.org/", ?sID)) AS ?hs)
    ?s ?p ?o
    OPTIONAL {
        {   
            SELECT ?o (SHA1(group_concat(?p; separator = ",")) as ?sID) WHERE {
                SELECT DISTINCT ?s ?p {    
                    ?o ?p ?_
                } order by ?p
            } group by ?o
        }
        BIND(URI(CONCAT("http://example.org/", ?oID)) AS ?ho2)
    }
    
    BIND(IF(BOUND(?oID), 
         ?ho2, 
         IF(?p = rdf:type, 
             ?o, 
             "")
  ) AS ?ho)
}
'

mapping: '
CONSTRUCT {
    ?hs <http://issummaryof> ?s .
    ?h0 <http://issummaryof> ?o .
}
WHERE
{
    {
        SELECT ?s (SHA1(group_concat(?p; separator = ",")) as ?sID) WHERE {
            SELECT DISTINCT ?s ?p {
                ?s ?p ?_
            } order by ?p
        } group by ?s
    }
    BIND(URI(CONCAT("http://example.org/", ?sID)) AS ?hs) 
    ?s ?p ?o
    OPTIONAL {
        {
            SELECT ?o (SHA1(group_concat(?p; separator = ",")) as ?oID) WHERE {
                SELECT DISTINCT ?o ?p {
                    ?o ?p ?_
                } order by ?p
            } group by ?o
        }
        BIND(URI(CONCAT("http://example.org/", ?oID)) AS ?ho2)
    }
    BIND(IF(BOUND(?oID), ?ho2, ?o) AS ?ho)
}'